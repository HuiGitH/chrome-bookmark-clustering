(lp0
S'http://lingxiankong.github.io/blog/2014/01/14/command-line-parser/'
p1
aS'Python\xe4\xb8\xad\xe7\x9a\x84\xe5\x91\xbd\xe4\xbb\xa4\xe8\xa1\x8c\xe8\xa7\xa3\xe6\x9e\x90\xe5\xb7\xa5\xe5\x85\xb7\xe4\xbb\x8b\xe7\xbb\x8d | Kong&#39;s Blog'
p2
aI0
aV<!DOCTYPE html>\u000a<html>\u000a<head>\u000a    <meta charset="utf-8" />\u000a    <title>Python\u4e2d\u7684\u547d\u4ee4\u884c\u89e3\u6790\u5de5\u5177\u4ecb\u7ecd | \u6280\u672f\u4eba\u751f</title>\u000a    <meta name="author" content="Kong" />\u000a    <meta name="description" content="Kong's Blog" />\u000a    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">\u000a    <link rel="stylesheet" href="/css/default.css" type="text/css" />\u000a    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />\u000a    <link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/atom.xml" />\u000a    <script src="/js/jquery-1.7.1.min.js" type="text/javascript"></script>\u000a    <script>\u000a      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\u000a      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\u000a      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\u000a      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');\u000a\u000a      ga('create', 'UA-48260695-1', 'lingxiankong.github.io');\u000a      ga('send', 'pageview');\u000a\u000a    </script>\u000a</head>\u000a<body>\u000a\u000a    <div class="home-menu">\u000a        <div class="home-icon-con">\u000a            <a class="home-menu-icon" href="/">\u9996\u9875</a>		\u000a            <a class="home-menu-icon" href="http://lingxiankong.github.io/">\u6280\u672f</a>\u000a            <a class="home-menu-icon" href="http://lingxiankong.github.io/opinion/">\u751f\u6d3b</a>\u000a            <a class="home-menu-icon" href="http://lingxiankong.github.io/me/1986/08/29/about-me/">\u5173\u4e8e\u6211</a>\u000a            <!--\u000a            <a class="home-follow" href="#" title="Contact Me">+</a>\u000a            -->\u000a        </div>\u000a        <!--\u000a        <div class="home-contact">\u000a            <a href="http://weibo.com/lingxiankong/" target="_blank" style="margin-left:-5px;"><img src="http://www.weibo.com/favicon.ico" alt="" width="25"/></a>\u000a        </div>\u000a        -->\u000a    </div>\u000a\u000a    <link rel="stylesheet" href="/js/prettify/prettify.css" />\u000a<style type="text/css">\u000a    body { background:#e8e8e8; }\u000a    @media screen and (max-width: 750px){\u000a        body { background:#fff; }\u000a    }\u000a    @media screen and (max-width: 1020px){\u000a        body { background:#fff; }\u000a    }\u000a</style>\u000a\u000a<div id="content">\u000a    <div class="entry">\u000a        <h1 class="entry-title"><a href="/blog/2014/01/14/command-line-parser/" title="Python\u4e2d\u7684\u547d\u4ee4\u884c\u89e3\u6790\u5de5\u5177\u4ecb\u7ecd">Python\u4e2d\u7684\u547d\u4ee4\u884c\u89e3\u6790\u5de5\u5177\u4ecb\u7ecd</a></h1>\u000a        <p class="entry-date">2014-01-14</p>\u000a        <p>\u58f0\u660e\uff1a<br />\u000a\u672c\u535a\u5ba2\u6b22\u8fce\u8f6c\u53d1\uff0c\u4f46\u8bf7\u4fdd\u7559\u539f\u4f5c\u8005\u4fe1\u606f!<br />\u000a\u65b0\u6d6a\u5fae\u535a\uff1a@\u5b54\u4ee4\u8d24HW\uff1b<br />\u000a\u535a\u5ba2\u5730\u5740\uff1ahttp://lingxiankong.github.io/<br />\u000a\u5185\u5bb9\u7cfb\u672c\u4eba\u53ca\u672c\u4eba\u56e2\u961f\u5b66\u4e60\u3001\u7814\u7a76\u548c\u603b\u7ed3\uff0c\u5982\u6709\u96f7\u540c\uff0c\u5b9e\u5c5e\u8363\u5e78\uff01</p>\u000a\u000a<h2 id="sysargv">sys.argv</h2>\u000a<p>\u6700\u7b80\u5355\u3001\u6700\u539f\u59cb\u7684\u65b9\u6cd5\u5c31\u662f\u624b\u52a8\u89e3\u6790\u4e86\u3002</p>\u000a\u000a<div class="highlighter-rouge"><pre class="highlight"><code>import sys\u000adef TestSys():\u000a  for arg in sys.argv[1:]:\u000a    print (arg)\u000a</code></pre>\u000a</div>\u000a\u000a<h2 id="getopt">getopt</h2>\u000a<p>getopt\u6a21\u5757\u662f\u539f\u6765\u7684\u547d\u4ee4\u884c\u9009\u9879\u89e3\u6790\u5668\uff0c\u652f\u6301UNIX\u51fd\u6570getopt()\u5efa\u7acb\u7684\u7ea6\u5b9a\u3002\u5b83\u4f1a\u89e3\u6790\u4e00\u4e2a\u53c2\u6570\u5e8f\u5217\uff0c\u5982sys.argv\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u5143\u7956\u5e8f\u5217\u548c\u4e00\u4e2a\u975e\u9009\u9879\u53c2\u6570\u5e8f\u5217\u3002\u76ee\u524d\u652f\u6301\u7684\u9009\u9879\u8bed\u6cd5\u5305\u62ec\u77ed\u683c\u5f0f\u548c\u957f\u683c\u5f0f\u9009\u9879\uff1a<code class="highlighter-rouge">-a</code>, <code class="highlighter-rouge">-bval</code>, <code class="highlighter-rouge">-b val</code>, <code class="highlighter-rouge">--noarg</code>, <code class="highlighter-rouge">--witharg=val</code>, <code class="highlighter-rouge">--witharg val</code>\u3002\u5982\u679c\u53ea\u662f\u7b80\u5355\u7684\u547d\u4ee4\u884c\u89e3\u6790\uff0cgetopt\u8fd8\u662f\u4e0d\u9519\u7684\u9009\u62e9\u3002\u4e00\u4e2a\u4f8b\u5b50\u5982\u4e0b\uff1a</p>\u000a\u000a<div class="highlighter-rouge"><pre class="highlight"><code>try:\u000a    options, remainder = getopt.getopt(sys.argv[1:], 'o:v', ['output=', 'verbose', 'version=',])\u000aexcept getopt.GetoptError as err:\u000a    print 'ERROR:', err\u000a    sys.exit(1)\u000a</code></pre>\u000a</div>\u000a\u000a<p>\u7b80\u5355\u8bf4\u660e\uff0c\u5982\u679c\u67d0\u4e2a\u5355\u5b57\u7b26\u9009\u9879\u9700\u8981\u53c2\u6570\uff0c\u5728\u4ed6\u540e\u9762\u52a0\u5192\u53f7\uff1b\u5bf9\u4e8e\u957f\u683c\u5f0f\u9009\u9879\uff0c\u8981\u52a0\u7b49\u53f7\u3002\u5982\u679cgetopt\u5728\u8f93\u5165\u53c2\u6570\u4e2d\u9047\u5230\u4e86\u2019\u2013\u2018\uff0c\u89e3\u6790\u4f1a\u505c\u6b62\u3002</p>\u000a\u000a<h2 id="argparse">argparse</h2>\u000a<blockquote>\u000a  <p>optparse was deprecated since version 2.7 and will not be developed further; development will continue with the argparse module.</p>\u000a</blockquote>\u000a\u000a<p><a href="http://docs.python.org/2/howto/argparse.html">argparse</a>\u662fpython\u6807\u51c6\u5e93\u4e2d\u7684\u6a21\u5757\uff0c\u4ee5\u524d\u7684optparse\u5df2\u7ecf\u5e9f\u5f03\u3002\u5229\u7528<a href="http://docs.python.org/2/howto/argparse.html">argparse</a>\uff0c\u53ef\u4ee5\u5b8c\u6210\u5bf9\u547d\u4ee4\u884c\u7684\u53c2\u6570\u5b9a\u4e49\u3001\u89e3\u6790\u4ee5\u53ca\u540e\u7eed\u7684\u5904\u7406\u3002\u4e00\u4e2a\u5f88\u7b80\u5355\u7684\u4f8b\u5b50\u5982\u4e0b\uff08\u6587\u4ef6\u540dprog.py\uff0c\u8fd9\u4e2a\u4f8b\u5b50\u5176\u5b9e\u4ec0\u4e48\u4e5f\u4e0d\u505a\uff09\uff1a</p>\u000a\u000a<div class="highlighter-rouge"><pre class="highlight"><code>import argparse\u000aparser = argparse.ArgumentParser(description="some information here")\u000aargs = parser.parse_args()\u000a</code></pre>\u000a</div>\u000a\u000a<p>\u8fd9\u6837\uff0cprog.py\u5c31\u80fd\u89e3\u6790\u547d\u4ee4\u884c\u53c2\u6570\u4e86\uff0c\u6309\u7167\u5982\u4e0b\u65b9\u5f0f\u8fd0\u884c\uff0c\u7ed3\u679c\u5982\u4e0b\uff1a</p>\u000a\u000a<div class="highlighter-rouge"><pre class="highlight"><code>$ python prog.py\u000a$ python prog.py --help\u000ausage: prog.py [-h]\u000a\u000aoptional arguments:\u000a  -h, --help  show this help message and exit\u000a$ python prog.py --verbose\u000ausage: prog.py [-h]\u000aprog.py: error: unrecognized arguments: --verbose\u000a$ python prog.py foo\u000ausage: prog.py [-h]\u000aprog.py: error: unrecognized arguments: foo\u000a</code></pre>\u000a</div>\u000a\u000a<p>\u5176\u5b9eArgumentParser\u51fd\u6570\u6709\u5f88\u591a\u53ef\u9009\u53c2\u6570\uff0cprog\u3001usage\u3001description\u3001epilog\u5206\u522b\u5b9a\u4e49\u89e3\u6790\u5668\u7684\u540d\u79f0\u3001\u4f7f\u7528\u8bf4\u660e\u3001\u63cf\u8ff0\u3001\u6700\u540e\u7684\u7ed3\u5c3e\u63cf\u8ff0\u3002\u4f7f\u7528<code class="highlighter-rouge">parents</code>\u8868\u793a\u5171\u4eab\u540c\u4e00\u4e2a\u7236\u7c7b\u89e3\u6790\u5668\uff08\u8fd9\u6837\u5c31\u53ef\u4ee5\u5171\u4eab\u7236\u7c7b\u89e3\u6790\u5668\u7684\u53c2\u6570\uff09\uff0c\u800c\u8fd9\u4e2a\u7236\u7c7b\u89e3\u6790\u5668\u901a\u5e38\u662f\u5982\u4e0b\u5b9a\u4e49\uff1a</p>\u000a\u000a<div class="highlighter-rouge"><pre class="highlight"><code>parent_parser = argparse.ArgumentParser(add_help=False)\u000a</code></pre>\u000a</div>\u000a\u000a<p>\u6b64\u5916\uff0c<code class="highlighter-rouge">formatter_class</code>\u5b9a\u4e49description\u7684\u663e\u793a\u683c\u5f0f\uff0c\u53d6\u503c\u53ef\u4ee5\u662f\u5982\u4e0b\u4e09\u79cd\uff0c\u5177\u4f53\u793a\u4f8b\u53c2\u89c1<a href="http://docs.python.org/2/library/argparse.html#formatter-class">\u6b64\u5904</a>\uff1a</p>\u000a\u000a<ul>\u000a  <li>RawDescriptionHelpFormatter\uff0c</li>\u000a  <li>RawTextHelpFormatter</li>\u000a  <li>ArgumentDefaultsHelpFormatter</li>\u000a</ul>\u000a\u000a<p>\u5176\u5b83\u8fd8\u6709\u5f88\u591a\u53c2\u6570\uff0c\u6b64\u5904\u5c31\u4e0d\u4e00\u4e00\u5217\u4e3e\u4e86\u3002</p>\u000a\u000a<h3 id="section">\u589e\u52a0\u53c2\u6570</h3>\u000a\u000a<div class="highlighter-rouge"><pre class="highlight"><code>ArgumentParser.add_argument(name or flags...[, action][, nargs][, const][, default][, type][, choices][, required][, help][, metavar][, dest])\u000a</code></pre>\u000a</div>\u000a\u000a<p>\u6bcf\u4e2a\u53c2\u6570\u89e3\u91ca\u5982\u4e0b:<br />\u000aname or flags - \u53c2\u6570\u7684\u540d\u5b57.<br />\u000aaction - \u9047\u5230\u53c2\u6570\u65f6\u7684\u52a8\u4f5c\uff0c\u9ed8\u8ba4\u503c\u662fstore\u3002store_const\uff0c\u8868\u793a\u8d4b\u503c\u4e3aconst\uff1bappend\uff0c\u5c06\u9047\u5230\u7684\u503c\u5b58\u50a8\u6210\u5217\u8868\uff0c\u4e5f\u5c31\u662f\u5982\u679c\u53c2\u6570\u91cd\u590d\u5219\u4f1a\u4fdd\u5b58\u591a\u4e2a\u503c; append_const\uff0c\u5c06\u53c2\u6570\u89c4\u8303\u4e2d\u5b9a\u4e49\u7684\u4e00\u4e2a\u503c\u4fdd\u5b58\u5230\u4e00\u4e2a\u5217\u8868\uff1bcount\uff0c\u5b58\u50a8\u9047\u5230\u7684\u6b21\u6570\uff1b\u6b64\u5916\uff0c\u4e5f\u53ef\u4ee5\u7ee7\u627fargparse.Action\u81ea\u5b9a\u4e49\u53c2\u6570\u89e3\u6790\uff1b<br />\u000anargs - \u53c2\u6570\u7684\u4e2a\u6570\uff0c\u53ef\u4ee5\u662f\u5177\u4f53\u7684\u6570\u5b57\uff0c\u6216\u8005\u662f?\u53f7\uff0c\u5f53\u4e0d\u6307\u5b9a\u503c\u65f6\u5bf9\u4e8ePositional argument\u4f7f\u7528default\uff0c\u5bf9\u4e8eOptional argument\u4f7f\u7528const\uff1b\u6216\u8005\u662f*\u53f7\uff0c\u8868\u793a0\u6216\u591a\u4e2a\u53c2\u6570\uff1b\u6216\u8005\u662f+\u53f7\u8868\u793a1\u6216\u591a\u4e2a\u53c2\u6570.<br />\u000aconst - action\u548cnargs\u6240\u9700\u8981\u7684\u5e38\u91cf\u503c.<br />\u000adefault - \u4e0d\u6307\u5b9a\u53c2\u6570\u65f6\u7684\u9ed8\u8ba4\u503c.<br />\u000atype - \u53c2\u6570\u7684\u7c7b\u578b.<br />\u000achoices - \u53c2\u6570\u5141\u8bb8\u7684\u503c.<br />\u000arequired - \u53ef\u9009\u53c2\u6570\u662f\u5426\u53ef\u4ee5\u7701\u7565(\u4ec5\u9488\u5bf9optionals). <br />\u000ahelp - \u53c2\u6570\u7684\u5e2e\u52a9\u4fe1\u606f\uff0c\u5f53\u6307\u5b9a\u4e3a<code class="highlighter-rouge">argparse.SUPPRESS</code>\u65f6\u8868\u793a\u4e0d\u663e\u793a\u8be5\u53c2\u6570\u7684\u5e2e\u52a9\u4fe1\u606f.<br />\u000ametavar - \u5728usage\u8bf4\u660e\u4e2d\u7684\u53c2\u6570\u540d\u79f0\uff0c\u5bf9\u4e8e\u5fc5\u9009\u53c2\u6570\u9ed8\u8ba4\u5c31\u662f\u53c2\u6570\u540d\u79f0\uff0c\u5bf9\u4e8e\u53ef\u9009\u53c2\u6570\u9ed8\u8ba4\u662f\u5168\u5927\u5199\u7684\u53c2\u6570\u540d\u79f0. <br />\u000adest - \u89e3\u6790\u540e\u7684\u53c2\u6570\u540d\u79f0\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5bf9\u4e8e\u53ef\u9009\u53c2\u6570\u9009\u53d6\u6700\u957f\u7684\u540d\u79f0\uff0c\u4e2d\u5212\u7ebf\u8f6c\u6362\u4e3a\u4e0b\u5212\u7ebf.</p>\u000a\u000a<p>\u4e00\u4e9b\u793a\u4f8b:</p>\u000a\u000a<div class="highlighter-rouge"><pre class="highlight"><code># \u53c2\u6570\u540d\u79f0\u4e3aecho\u000aparser.add_argument("echo", help="echo the string you use here")\u000a# \u53ef\u4ee5\u589e\u52a0\u7c7b\u578b\u000aparser.add_argument("square", help="display a square of a given number",\u000a                type=int)\u000a# \u53ef\u9009\u53c2\u6570\u524d\u9762\u591a\u4e86--\u7b26\u53f7\uff0c-v\u662f\u7b80\u5199\u5f62\u5f0f\uff0cstore_true\u8bf4\u660e\u78b0\u5230\u8be5\u53c2\u6570\u65f6\u4fdd\u5b58\u4e3atrue\uff0c\u5426\u5219\u5c31\u662ffalse\u000aparser.add_argument("-v", "--verbose", help="increase output verbosity",\u000a                action="store_true")\u000a# \u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u8fd9\u6837\u5199\uff0c\u89c4\u5b9a\u4e86\u53ef\u9009\u53c2\u6570\u7684\u7c7b\u578b\u548c\u53d6\u503c\u8303\u56f4\u000aparser.add_argument("-v", "--verbosity", type=int, choices=[0, 1, 2],\u000a                help="increase output verbosity")\u000a# count\u8868\u793a\u9047\u5230\u8be5\u53c2\u6570\u51e0\u6b21\uff0c\u503c\u5c31\u52a0\u51e0\uff0c\u9ed8\u8ba4\u503c\u662f0\u000aparser.add_argument("-v", "--verbosity", action="count", default=0,\u000a                help="increase output verbosity")\u000a</code></pre>\u000a</div>\u000a\u000a<p>\u589e\u52a0\u4e92\u65a5\u7c7b\u578b\u7684\u53c2\u6570\uff1a</p>\u000a\u000a<div class="highlighter-rouge"><pre class="highlight"><code>group = parser.add_mutually_exclusive_group()\u000agroup.add_argument("-v", "--verbose", action="store_true")\u000agroup.add_argument("-q", "--quiet", action="store_true")\u000a</code></pre>\u000a</div>\u000a\u000a<p>\u5982\u679c\u5fc5\u9009\u53c2\u6570\u7684\u503c\u4ee5-\u5f00\u5934\uff0c\u9700\u8981\u5728\u8f93\u5165\u547d\u4ee4\u65f6\u7279\u6b8a\u5904\u7406\uff1a</p>\u000a\u000a<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt;&gt; parser = argparse.ArgumentParser(prog='PROG')\u000a&gt;&gt;&gt; parser.add_argument('foo', nargs='?')\u000a&gt;&gt;&gt; parser.parse_args(['--', '-f'])\u000aNamespace(foo='-f')\u000a</code></pre>\u000a</div>\u000a\u000a<h3 id="sub-commands">Sub-commands</h3>\u000a<p>\u5c06\u591a\u4e2a\u547d\u4ee4\u7ec4\u5408\u8fdb\u4e00\u4e2a\u7a0b\u5e8f\u4e2d\uff0c\u4f7f\u7528\u5b50\u89e3\u6790\u5668\u6765\u5904\u7406\u547d\u4ee4\u884c\u7684\u6bcf\u4e2a\u90e8\u5206\u3002\u5c31\u50cfsvn\uff0c\u4ee5\u53caOpenStack\u5404\u4e2a\u7ec4\u4ef6\u90a3\u6837\u3002</p>\u000a\u000a<div class="highlighter-rouge"><pre class="highlight"><code>ArgumentParser.add_subparsers([title][, description][, prog][, parser_class][, action][, option_string][, dest][, help][, metavar])\u000a\u000a&gt;&gt;&gt; # create the top-level parser\u000a&gt;&gt;&gt; parser = argparse.ArgumentParser(prog='PROG')\u000a&gt;&gt;&gt; parser.add_argument('--foo', action='store_true', help='foo help')\u000a&gt;&gt;&gt; subparsers = parser.add_subparsers(help='sub-command help')\u000a&gt;&gt;&gt;\u000a&gt;&gt;&gt; # create the parser for the "a" command\u000a&gt;&gt;&gt; parser_a = subparsers.add_parser('a', help='a help')\u000a&gt;&gt;&gt; parser_a.add_argument('bar', type=int, help='bar help')\u000a&gt;&gt;&gt;\u000a&gt;&gt;&gt; # create the parser for the "b" command\u000a&gt;&gt;&gt; parser_b = subparsers.add_parser('b', help='b help')\u000a&gt;&gt;&gt; parser_b.add_argument('--baz', choices='XYZ', help='baz help')\u000a&gt;&gt;&gt;\u000a&gt;&gt;&gt; # parse some argument lists\u000a&gt;&gt;&gt; parser.parse_args(['a', '12'])\u000aNamespace(bar=12, foo=False)\u000a&gt;&gt;&gt; parser.parse_args(['--foo', 'b', '--baz', 'Z'])\u000aNamespace(baz='Z', foo=True)\u000a</code></pre>\u000a</div>\u000a\u000a<h3 id="partial-parsing">Partial parsing</h3>\u000a\u000a<div class="highlighter-rouge"><pre class="highlight"><code>ArgumentParser.parse_known_args(args=None, namespace=None)\u000a</code></pre>\u000a</div>\u000a\u000a<p>\u5176\u5b9e\u4e0e<code class="highlighter-rouge">parse_args()</code>\u7c7b\u4f3c\uff0c\u4f46\u5f53\u78b0\u5230\u591a\u4f59\u7684\u53c2\u6570\u65f6\u4e0d\u629b\u51fa\u9519\u8bef\uff0c\u800c\u662f\u8fd4\u56de\u4e00\u4e2a\u4e8c\u5143\u7ec4\u3002</p>\u000a\u000a<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt;&gt; parser = argparse.ArgumentParser()\u000a&gt;&gt;&gt; parser.add_argument('--foo', action='store_true')\u000a&gt;&gt;&gt; parser.add_argument('bar')\u000a&gt;&gt;&gt; parser.parse_known_args(['--foo', '--badger', 'BAR', 'spam'])\u000a(Namespace(bar='BAR', foo=True), ['--badger', 'spam'])\u000a</code></pre>\u000a</div>\u000a\u000a<p>\u5bf9\u4e8eargparse\u7684\u9ad8\u7ea7\u4f7f\u7528\uff0c\u5efa\u8bae\u76f4\u63a5\u770b\u4e00\u4e0bOpenStack\u4e2dOslo\u7ec4\u4ef6\u7684\u6e90\u7801\uff0c\u4f1a\u53d7\u76ca\u532a\u6d45\u7684\u3002</p>\u000a\u000a<h2 id="docopt">docopt</h2>\u000a<p><a href="http://docopt.org/">docopt</a>\u5c31\u6bd4\u8f83\u5f3a\u5927\u4e86\uff0c\u5b83\u662f\u6839\u636e\u4f60\u81ea\u5df1\u5199\u7684help messages\uff08\u6587\u6863\u63cf\u8ff0\uff09\uff0c\u81ea\u52a8\u4e3a\u4f60\u751f\u6210parser\u3002\u4f7f\u7528\u4e4b\u524d\u9700\u8981\u4e0b\u8f7d<a href="https://pypi.python.org/pypi/docopt">\u76f8\u5e94\u7684\u5e93</a>\uff0c<a href="http://try.docopt.org/">\u8fd9\u91cc</a>\u6709\u4e2a\u754c\u9762\u53ef\u4ee5\u8bd5\u7528\u4e00\u4e0b<a href="http://docopt.org/">docopt</a>\u7684\u5f3a\u5927\uff0c\u501f\u7528\u5b98\u65b9\u7684\u4e00\u4e2a\u4f8b\u5b50\uff1a</p>\u000a\u000a<div class="highlighter-rouge"><pre class="highlight"><code>"""Usage: arguments_example.py [-vqrh] [FILE] ...\u000a          arguments_example.py (--left | --right) CORRECTION FILE\u000a\u000aProcess FILE and optionally apply correction to either left-hand side or\u000aright-hand side.\u000a\u000aArguments:\u000a  FILE        optional input file\u000a  CORRECTION  correction angle, needs FILE, --left or --right to be present\u000a\u000aOptions:\u000a  -h --help\u000a  -v       verbose mode\u000a  -q       quiet mode\u000a  -r       make report\u000a  --left   use left-hand side\u000a  --right  use right-hand side\u000a\u000a"""\u000afrom docopt import docopt\u000a\u000a\u000aif __name__ == '__main__':\u000a    arguments = docopt(__doc__)\u000a    print(arguments)\u000a</code></pre>\u000a</div>\u000a\u000a<p>\u6587\u6863\u63cf\u8ff0\u6709\u4e24\u4e2a\u90e8\u5206\uff1a<code class="highlighter-rouge">Usage</code>\u548c<code class="highlighter-rouge">Option </code>.<br />\u000a<code class="highlighter-rouge">Usage</code>: \u4ee5\u4e00\u4e2a\u7a7a\u884c\u7ed3\u675f\uff0c\u5192\u53f7\u540e\u9762\u7684\u7b2c\u4e00\u4e2a\u5355\u8bcd\u4f5c\u4e3a\u7a0b\u5e8f\u7684\u540d\u79f0\u3002\u540d\u79f0\u540e\u9762\u5c31\u662f\u53c2\u6570\u7684\u63cf\u8ff0\uff0c\u53ef\u4ee5\u5305\u62ec\uff1a</p>\u000a\u000a<ul>\u000a  <li>\u5fc5\u9009\u53c2\u6570\u3002\u662f\u5168\u5927\u5199\u7684\u5355\u8bcd\u6216\u5c16\u62ec\u53f7\u62ec\u8d77\u6765\u7684\u7684\u5355\u8bcd</li>\u000a  <li>\u53ef\u9009\u53c2\u6570\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c-oiv\u53ef\u4ee5\u8868\u793a-o -i -v\u3002\u53ef\u9009\u53c2\u6570\u7684\u5f62\u5f0f\u53ef\u4ee5\u662f\u2013input=FILE or -i FILE or even -iFILE.</li>\u000a  <li>\u5b50\u547d\u4ee4\u3002</li>\u000a</ul>\u000a\u000a<p>[]\u8868\u793a\u53ef\u9009\u53c2\u6570\uff0c\u5982<code class="highlighter-rouge">my_program.py [-hvqo FILE]</code>\uff1b<br />\u000a( )\u8868\u793a\u5fc5\u9009\u53c2\u6570\uff0c\u4ee5\u53ca\u6ca1\u6709\u5305\u542b\u5728[]\u4e2d\u90fd\u4f5c\u4e3a\u5fc5\u9009\u53c2\u6570\u3002 <br />\u000a|\u8868\u793a\u4e92\u65a5\u53c2\u6570<br />\u000a\u2026 \u8868\u793a\u63a5\u6536\u591a\u4e2a\u53c2\u6570\u503c\uff0c\u5982<code class="highlighter-rouge">my_program.py FILE ...</code></p>\u000a\u000a<p><code class="highlighter-rouge">Options</code>\uff1a\u53ef\u9009\u53c2\u6570\u7684\u63cf\u8ff0\u3002<br />\u000a\u6bcf\u4e00\u884c\u4ee5- or \u2013\u5f00\u5934\uff1b\u540c\u4e00\u884c\u76f8\u540c\u53ef\u9009\u53c2\u6570\u4ee5\u7a7a\u683c\u9694\u5f00\uff1b\u4e24\u4e2a\u6216\u4ee5\u4e0a\u7684\u7a7a\u683c\u5206\u9694\u63cf\u8ff0\uff1b\u53ef\u4ee5\u5b9a\u4e49\u9ed8\u8ba4\u503c\uff08<code class="highlighter-rouge">[default: value]</code>\uff09\uff1b</p>\u000a\u000a<p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c<a href="http://docopt.org/">docopt</a>\u4e0d\u80fd\u5b8c\u6210<a href="http://docs.python.org/2/howto/argparse.html">argparse</a>\u5177\u6709\u7684\u53c2\u6570\u503c\u6821\u9a8c\u7684\u529f\u80fd\u3002\u76ee\u524d<a href="http://docopt.org/">docopt</a>\u5df2\u7ecf\u88ab\u79fb\u690d\u5230\u4e86Ruby, PHP\u7b49\u8bed\u8a00<br />\u000a\u66f4\u591a\u7684\u4f8b\u5b50\u53ef\u4ee5\u53c2\u8003<a href="https://github.com/docopt/docopt/tree/master/examples">\u8fd9\u91cc</a></p>\u000a\u000a<h2 id="clize">clize</h2>\u000a<p><a href="http://clize.readthedocs.org/en/latest/">clize</a>\u4e5f\u6bd4\u8f83\u5f3a\u5927\uff0c\u5229\u7528\u88c5\u9970\u5668\u5c06\u51fd\u6570\u8f6c\u6362\u6210\u547d\u4ee4\u884c\u89e3\u6790\u5668\u3002github\u5730\u5740\uff1a<a href="https://github.com/epsy/clize">https://github.com/epsy/clize</a>\uff0c\u4e00\u4e2a\u4f8b\u5b50\uff1a</p>\u000a\u000a<div class="highlighter-rouge"><pre class="highlight"><code><span class="c">#!/usr/bin/env python</span>\u000a<span class="kn">from</span> <span class="nn">clize</span> <span class="kn">import</span> <span class="n">run</span>\u000a<span class="kn">from</span> <span class="nn">sigtools.modifiers</span> <span class="kn">import</span> <span class="n">autokwoargs</span>\u000a\u000a<span class="nd">@autokwoargs</span>\u000a<span class="k">def</span> <span class="nf">echo</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s">''</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s">''</span><span class="p">):</span>\u000a    <span class="s">"""Echoes text back\u000a\u000a    word: One word or quoted string to echo back\u000a\u000a    prefix: Prepend this to each line in word\u000a\u000a    suffix: Append this to each line in word\u000a    """</span>\u000a    <span class="k">if</span> <span class="n">prefix</span> <span class="ow">or</span> <span class="n">suffix</span><span class="p">:</span>\u000a        <span class="k">return</span> <span class="s">'</span><span class="se">\u005cn</span><span class="s">'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="n">line</span> <span class="o">+</span> <span class="n">suffix</span>\u000a                         <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">word</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\u005cn</span><span class="s">'</span><span class="p">))</span>\u000a    <span class="k">return</span> <span class="n">word</span>\u000a\u000a<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>\u000a    <span class="n">run</span><span class="p">(</span><span class="n">echo</span><span class="p">)</span>\u000a</code></pre>\u000a</div>\u000a\u000a<p>\u751f\u6210\u7684\u5e2e\u52a9\u6587\u6863\u5982\u4e0b\uff1a</p>\u000a\u000a<div class="highlighter-rouge"><pre class="highlight"><code>$ ./echo.py --help\u000aUsage: ./echo.py [OPTIONS] word\u000a\u000aEchoes text back\u000a\u000aPositional arguments:\u000a  word   One word or quoted string to echo back\u000a\u000aOptions:\u000a  --prefix=STR   Prepend this to each line in word(default: )\u000a  --suffix=STR   Append this to each line in word(default: )\u000a\u000aOther actions:\u000a  -h, --help   Show the help\u000a</code></pre>\u000a</div>\u000a\u000a<p>\u4f46\u4e2a\u4eba\u611f\u89c9<a href="http://clize.readthedocs.org/en/latest/">clize</a>\u4e0e<a href="http://docs.python.org/2/howto/argparse.html">argparse</a>\u548c<a href="http://docopt.org/">docopt</a>\u6bd4\u8d77\u6765\uff0c\u652f\u6301\u7684\u529f\u80fd\u76f8\u5bf9\u8fd8\u6bd4\u8f83\u5c11\uff0c\u800c\u4e14\u4e0d\u5bb9\u6613\u4e0a\u624b\uff08\u56e0\u4e3a\u8981\u719f\u6089\u76f8\u5173\u7684\u5404\u79cd\u88c5\u9970\u5668\u53ca\u5176\u53c2\u6570\u7684\u4f7f\u7528\uff09\uff0c\u8981\u652f\u6301\u9ad8\u7ea7\u89e3\u6790\u529f\u80fd\uff0c\u4ee3\u7801\u5199\u8d77\u6765\u6bd4\u8f83\u8d39\u52b2\u3002</p>\u000a\u000a<h2 id="argparseopenstack">argparse\u5728OpenStack\u4e2d\u7684\u4f7f\u7528</h2>\u000a<p>OpenStack\u5404\u4e2a\u7ec4\u4ef6\u90fd\u6709\u76f8\u5e94\u7684\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u4ee5novaclient\u4e3a\u4f8b\uff0c\u5c31\u5145\u5206\u5229\u7528\u4e86<a href="http://docs.python.org/2/howto/argparse.html">argparse</a>\u6765\u5b9e\u73b0\u547d\u4ee4\u884c\u7684\u89e3\u6790\u3002</p>\u000a\u000a<p>\u5728novaclient\u811a\u672c\u7684\u5f00\u59cb\u5904\uff0c\u5c31\u662f<a href="http://docs.python.org/2/howto/argparse.html">argparse</a>\u7684\u5178\u578b\u7528\u6cd5\uff1a<br />\u000a<img src="/images/2014-01-14-command-line-parser/1.png" alt="" /><br />\u000a\u5176\u4e2d<code class="highlighter-rouge">NovaClientArgumentParser</code>\u5c31\u662f\u7ee7\u627f\u81ea<code class="highlighter-rouge">argparse.ArgumentParser</code>\uff0c\u63a5\u4e0b\u6765\u5c31\u662f\u6dfb\u52a0Sub-commands\uff0c\u7136\u540e\u5bf9\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u89e3\u6790:  <br />\u000a<img src="/images/2014-01-14-command-line-parser/2.png" alt="" /><br />\u000a\u5982\u679c\u719f\u6089\u4e86\u4e0a\u9762\u5bf9<a href="http://docs.python.org/2/howto/argparse.html">argparse</a>\u7684\u8bb2\u89e3\uff0c\u57fa\u672c\u4e0a\u5c31\u53ef\u4ee5\u5f00\u59cb\u8fdb\u884cnovaclient\u7684\u5f00\u53d1\u4e86\u3002</p>\u000a\u000a\u000a\u000a        <div id="disqus_thread"></div>\u000a        <script type="text/javascript">\u000a            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */\u000a            var disqus_shortname = 'lingxiankong'; // required: replace example with your forum shortname\u000a\u000a            /* * * DON'T EDIT BELOW THIS LINE * * */\u000a            (function() {\u000a                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;\u000a                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';\u000a                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);\u000a            })();\u000a        </script>\u000a        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>\u000a        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>\u000a    </div>\u000a\u000a    <div class="sidenav">\u000a        <iframe width="100%" height="75" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=75&fansRow=2&ptype=1&speed=0&skin=5&isTitle=0&noborder=0&isWeibo=0&isFans=0&uid=1847576883&verifier=efc8c820&dpc=1"></iframe>\u000a    </div>\u000a\u000a</div>\u000a\u000a<script src="/js/post.js" type="text/javascript"></script>\u000a\u000a\u000a    <script type="text/javascript">\u000a        $(function(){\u000a            $('.home-follow').click(function(e){\u000a                e.preventDefault();\u000a\u000a                if($('.home-contact').is(':visible')){\u000a                    $('.home-contact').slideUp(100);\u000a                }else{\u000a                    $('.home-contact').slideDown(100);\u000a                }\u000a            });\u000a        })\u000a    </script>\u000a</body>\u000a</html>\u000a
p3
a.